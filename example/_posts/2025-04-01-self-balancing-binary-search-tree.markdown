---
layout: post
title:  "ìê¸° ê· í˜• ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬(Self-Balancing Binary Search Tree)"
date:   2025-03-30
hide_last_modified: true
---

* toc  
{:toc .large-only}

AVL íŠ¸ë¦¬ (Adelson-Velsky & Landis) ì™€ ë ˆë“œë¸”ë™ íŠ¸ë¦¬ ê°™ì€ ê²½ìš° ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬(Binary Search Tree, BST)ì˜ ì¼ì¢…ìœ¼ë¡œ, ìê¸° ê· í˜• ì´ì§„ íŠ¸ë¦¬(Self-balancing BST) ì¤‘ í•˜ë‚˜ì•¼. ìê¸° ê· í˜• ì´ì§„ íŠ¸ë¦¬ê°€ í•„ìš”í•œ ì´ìœ ëŠ” ì˜ˆì „ì— ë‚´ê°€ ë‹¤ë¤˜ë˜ ì´ì§„ ê²€ìƒ‰íŠ¸ë¦¬ì— ëŒ€í•´ì„œ ìƒê°í•´ ë´ì•¼í•´. ì´ì „ ì´ì§„ ê²€ìƒ‰ íŠ¸ë¦¬ ê°™ì€ ê²½ìš° í‚¤ì˜ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ë…¸ë“œê°€ ì‚½ì…ë˜ë©´ íŠ¸ë¦¬ì˜ ë†’ì´ê°€ ê¹Šì–´ì ¸ ì„ í˜• ë¦¬ìŠ¤íŠ¸ê°€ ë˜ë©´ ë¹ ë¥¸ ê²€ìƒ‰ì„ ëª»í•´. ê·¸ë˜ì„œ ë†’ì´ ì œí•œì„ í•˜ê³ ì ê· í˜• ì´ì§„ íŠ¸ë¦¬ê°€ ê³ ì•ˆë˜ì—ˆì–´

![ê· í˜• ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬](/assets/img/blog/computerscience/ê· í˜•ì´ì§„íƒìƒ‰íŠ¸ë¦¬.png)

- AVL íŠ¸ë¦¬ëŠ” ëª¨ë“  ë…¸ë“œì— ëŒ€í•´ ***ì™¼ìª½ê³¼ ì˜¤ë¥¸ìª½ ì„œë¸ŒíŠ¸ë¦¬ì˜ ë†’ì´ ì°¨ì´(ê· í˜• ì¸ìˆ˜)ê°€ -1, 0, 1ì„ ìœ ì§€í•˜ë„ë¡ ìë™ìœ¼ë¡œ ê· í˜•***ì„ ë§ì¶°ì£¼ëŠ” íŠ¸ë¦¬ì•¼

- ë ˆë“œ ë¸”ë™ íŠ¸ë¦¬ ê°™ì€ ê²½ìš° ***ì¡°ê¸ˆ ë” ëŠìŠ¨í•˜ê²Œ ê· í˜•ì„ ì¡ì•„ì„œ ì‚½ì…/ì‚­ì œ ì‹œ ì—°ì‚°ì´ ë” ë¹ ë¥´ë‹¤ëŠ” ì¥ì ***ì´ ìˆì–´

## AVL íŠ¸ë¦¬ (Adelson-Velsky & Landis)

ì¼ë°˜ì ì¸ BSTëŠ” ì‚½ì…/ì‚­ì œê°€ ë°˜ë³µë˜ë©´ í•œìª½ìœ¼ë¡œ ì¹˜ìš°ì³ì„œ **ì„ í˜• êµ¬ì¡°(Linked List)**ê°€ ë˜ì–´ë²„ë¦´ ìˆ˜ ìˆì–´. ê·¸ëŸ¼ ê²€ìƒ‰ ì†ë„ë„ O(log n)ì´ ì•„ë‹ˆë¼ O(n)ì´ ë˜ì–´ë²„ë ¤ ğŸ˜¥

ê·¸ë˜ì„œ AVL íŠ¸ë¦¬ëŠ” ì´ëŸ° ë¶ˆê· í˜•ì„ ë°©ì§€í•´ì„œ í•­ìƒ O(log n) ì‹œê°„ë³µì¡ë„ë¥¼ ë³´ì¥í•˜ê²Œ í•´ì£¼ëŠ” ê±°ì§€!

### AVL íŠ¸ë¦¬ì˜ í•µì‹¬ ìš”ì†Œ

- **ë†’ì´(height)** : ë…¸ë“œì˜ ë†’ì´ëŠ” ìì‹ ì„ ë£¨íŠ¸ë¡œ í•˜ëŠ” ì„œë¸ŒíŠ¸ë¦¬ì˜ ìµœëŒ€ ê¹Šì´ë¥¼ ì˜ë¯¸í•´

- **ê· í˜• ì¸ìˆ˜(balance factor)** : ì•„ë˜ì˜ ê°’ì´ -1, 0, 1ì„ ë„˜ìœ¼ë©´ ê· í˜•ì´ ê¹¨ì¡Œë‹¤ê³  íŒë‹¨í•˜ê³ , íšŒì „ì„ í†µí•´ ë‹¤ì‹œ ê· í˜•ì„ ë§ì¶°ì•¼í•´

~~~python
balance_factor = height(left subtree) - height(right subtree)
~~~

### AVL ì‘ë™ ì›ë¦¬

ê· í˜• ì¸ìˆ˜ê°’ì´ ë„˜ì–´ì„œë©´(íŠ¸ë¦¬ì˜ ê· í˜•ì´ ê¹¨ì§€ë©´), 4ê°€ì§€ ìœ í˜•ì˜ íšŒì „ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•´ì„œ ê· í˜•ì„ ë§ì¶°

#### 1. LLíšŒì „(ë‹¨ìˆœ ì˜¤ë¥¸ìª½ íšŒì „)

- ì™¼ìª½ ìì‹ì˜ ì™¼ìª½ì— ì‚½ì…ëœ ê²½ìš°

~~~python
    # LL
    if balance > 1 and key < node.left.key:
        return right_rotate(node)
~~~

#### 2. RRíšŒì „(ë‹¨ìˆœ ì™¼ìª½ íšŒì „)

- ì˜¤ë¥¸ìª½ ìì‹ì˜ ì˜¤ë¥¸ìª½ì— ì‚½ì…ëœ ê²½ìš°

~~~python
   # RR
    if balance < -1 and key > node.right.key:
        return left_rotate(node)
~~~

#### 3. LRíšŒì „(ì™¼ìª½ ìì‹ì˜ ì˜¤ë¥¸ìª½ â†’ ë‘ ë²ˆ íšŒì „)

- ì™¼ìª½ ìì‹ì˜ ì˜¤ë¥¸ìª½ì— ì‚½ì…ëœ ê²½ìš°

~~~python
    # LR
    if balance > 1 and key > node.left.key:
        node.left = left_rotate(node.left)
        return right_rotate(node)
~~~

#### 4. RLíšŒì „(ì˜¤ë¥¸ìª½ ìì‹ì˜ ì™¼ìª½ â†’ ë‘ ë²ˆ íšŒì „)

- ì˜¤ë¥¸ìª½ ìì‹ì˜ ì™¼ìª½ì— ì‚½ì…ëœ ê²½ìš°

~~~python
    # RL
    if balance < -1 and key < node.right.key:
        node.right = right_rotate(node.right)
        return left_rotate(node)
~~~

### AVL í•¨ìˆ˜

~~~python
class AVLNode:
    def __init__(self, key):
        self.key = key
        self.left = None
        self.right = None
        self.height = 1  # ë…¸ë“œ ë†’ì´ ì´ˆê¸°ê°’ (leaf = 1)

# ë†’ì´ ë°˜í™˜ í•¨ìˆ˜
def get_height(node):
    if not node:
        return 0
    return node.height

# ê· í˜• ì¸ìˆ˜ ê³„ì‚°
def get_balance(node):
    if not node:
        return 0
    return get_height(node.left) - get_height(node.right)

def right_rotate(y):
    x = y.left # xëŠ” yì˜ ì™¼ìª½ ìì‹ì˜ ê°’ì„ ë°›ëŠ”ë‹¤
    T2 = x.right # T2ëŠ” xì˜ ì˜¤ë¥¸ìª½ ìì‹ì˜ ê°’ì„ ë°›ëŠ”ë‹¤

    # íšŒì „ ìˆ˜í–‰
    x.right = y
    y.left = T2

    # ë†’ì´ ì—…ë°ì´íŠ¸
    y.height = max(get_height(y.left), get_height(y.right)) + 1
    x.height = max(get_height(x.left), get_height(x.right)) + 1

    return x

def left_rotate(x):
    y = x.right
    T2 = y.left

    # íšŒì „ ìˆ˜í–‰
    y.left = x
    x.right = T2

    # ë†’ì´ ì—…ë°ì´íŠ¸
    x.height = max(get_height(x.left), get_height(x.right)) + 1
    y.height = max(get_height(y.left), get_height(y.right)) + 1

    return y

def insert(node, key):
    # 1. BST ì‚½ì…
    if not node:
        return AVLNode(key) # root ë…¸ë“œë¥¼ ìƒˆë¡œ ìƒì„±ì„±
    elif key < node.key: # keyê°€ ë…¸ë“œì˜ ê°’ë³´ë‹¤ ì‘ë‹¤ë©´
        node.left = insert(node.left, key) # ì™¼ìª½ë…¸ë“œë¡œ ë‹¤ì‹œ ì¬ê·€
    else:
        node.right = insert(node.right, key) # keyê°€ ë…¸ë“œì˜ ê°’ë³´ë‹¤ í¬ë‹¤ë©´ ì˜¤ë¥¸ìª½ ë…¸ë“œë¡œ ë‹¤ì‹œ ì¬ê·€

    # 2. ë†’ì´ ì—…ë°ì´íŠ¸
    node.height = 1 + max(get_height(node.left), get_height(node.right)) # ì™¼ìª½ ì„œë¸ŒíŠ¸ë¦¬ì™€ ì˜¤ë¥¸ìª½ ì„œë¸ŒíŠ¸ë¦¬ì˜ ë§¥ìŠ¤ê°’ì— + 1

    # 3. ê· í˜• ì¸ìˆ˜ ê³„ì‚°
    balance = get_balance(node)

    # 4. íšŒì „ìœ¼ë¡œ ê· í˜• ì¡ê¸°
    # LL
    if balance > 1 and key < node.left.key:
        return right_rotate(node)

    # RR
    if balance < -1 and key > node.right.key:
        return left_rotate(node)

    # LR
    if balance > 1 and key > node.left.key:
        node.left = left_rotate(node.left)
        return right_rotate(node)

    # RL
    if balance < -1 and key < node.right.key:
        node.right = right_rotate(node.right)
        return left_rotate(node)

    return node
~~~

## ë ˆë“œë¸”ë™ íŠ¸ë¦¬(Red-Black Tree)

- íŠ¸ë¦¬ì˜ ê· í˜•ì„ ìœ ì§€í•´ì„œ ìµœì•…ì˜ ê²½ìš°ì—ë„ íƒìƒ‰/ì‚½ì…/ì‚­ì œê°€ O(log n) ì´ ë˜ê²Œ ë§Œë“ ë‹¤.

- ì‚½ì…/ì‚­ì œ ì—°ì‚°ì´ ìì£¼ ì¼ì–´ë‚˜ëŠ” í™˜ê²½ì— ì í•©í•˜ë‹¤.

### ë ˆë“œë¸”ë™ íŠ¸ë¦¬ì˜ í•µì‹¬ ê·œì¹™

ë ˆë“œë¸”ë™ íŠ¸ë¦¬ëŠ” ë…¸ë“œì— ìƒ‰ìƒ ì •ë³´ë¥¼ ì¶”ê°€í•´ì„œ ê· í˜•ì„ ìœ ì§€í•´.
ê° ë…¸ë“œëŠ” ë¹¨ê°„ìƒ‰(red) ë˜ëŠ” ê²€ì€ìƒ‰(black) ì¤‘ í•˜ë‚˜ì•¼

1. ë…¸ë“œëŠ” ë¹¨ê°• í˜¹ì€ ê²€ì •ì´ë‹¤

2. ë£¨íŠ¸ëŠ” í•­ìƒ ê²€ì •ì´ë‹¤

3. ëª¨ë“  ë¦¬í”„(NIL ë…¸ë“œ)ëŠ” ê²€ì •ì´ë‹¤. ì—¬ê¸°ì„œ ë¦¬í”„ëŠ” ì‹¤ì œ ê°’ì´ ì•„ë‹ˆë¼ "ì—†ìŒ(None)"ì„ ë‚˜íƒ€ë‚´ëŠ” NIL ë…¸ë“œë¥¼ ë§í•´

4. ì–´ë–¤ ë…¸ë“œê°€ ë¹¨ê°•ì´ë¼ë©´, ê·¸ ìì‹ ë‘˜ì€ ë°˜ë“œì‹œ ê²€ì •ì´ë‹¤. ì¦‰, ë¹¨ê°• ë…¸ë“œëŠ” ì—°ì†ìœ¼ë¡œ ì˜¬ ìˆ˜ ì—†ë‹¤(Red-Red violation ë°©ì§€)

5. ì–´ë–¤ ë…¸ë“œì—ì„œ ë¦¬í”„ê¹Œì§€ ê°€ëŠ” ëª¨ë“  ê²½ë¡œì—ëŠ” ê°™ì€ ê°œìˆ˜ì˜ ê²€ì • ë…¸ë“œê°€ ìˆë‹¤. ì´ë¥¼ ê²€ì • ë†’ì´(Black Height)ë¼ê³  í•¨

ì—¬ê¸°ì„œ 4ë²ˆê³¼ 5ë²ˆ ê·œì¹™ ë•ì— íŠ¸ë¦¬ê°€ ì§€ë‚˜ì¹˜ê²Œ í•œìª½ìœ¼ë¡œ ì¹˜ìš°ì¹˜ëŠ” ê²ƒì„ ë°©ì§€í•´. ì‹¤ì œë¡œ ë ˆë“œë¸”ë™ íŠ¸ë¦¬ì˜ ë†’ì´ëŠ” 2*log(n)ì´í•˜ë¡œ ì œí•œë¼

### ë ˆë“œë¸”ë™ íŠ¸ë¦¬ì˜ ì£¼ìš” ì—°ì‚°(ì‚½ì… & ì‚­ì œì œ)

ë ˆë“œë¸”ë™ íŠ¸ë¦¬ëŠ” ì‚½ì…/ì‚­ì œ ì´í›„ì— ê· í˜•ì„ ë§ì¶”ê¸° ìœ„í•´ íšŒì „(Rotation)ê³¼ ì¬ìƒ‰ì¹ (Recoloring)ì„ ì‚¬ìš©í•´

#### ì‚½ì…

- ì¼ë°˜ì ì¸ BST ë°©ì‹ìœ¼ë¡œ ë…¸ë“œë¥¼ ì‚½ì…í•œë‹¤. ìƒˆ ë…¸ë“œëŠ” í•­ìƒ ë¹¨ê°•ìœ¼ë¡œ ì‹œì‘í•œë‹¤

- ì‚½ì… í›„ ê·œì¹™ ìœ„ë°˜ì´ ìˆìœ¼ë©´ ìƒ‰ ë³€ê²½ í˜¹ì€ íšŒì „ìœ¼ë¡œ ê· í˜•ì„ ë§ì¶˜ë‹¤

- ì¡°ìƒì˜ ìƒ‰ì„ ë°”ê¾¸ê±°ë‚˜, ì‚¼ì´Œ ë…¸ë“œê°€ ë¹¨ê°•ì¸ì§€ ê²€ì •ì¸ì§€ì— ë”°ë¼ ì—¬ëŸ¬ ê²½ìš°ë¡œ ë‚˜ë‰œë‹¤

#### ì‚­ì œ

- ì‚­ì œëŠ” ì¡°ê¸ˆ ë³µì¡í•œë°, ì‚­ì œ í›„ ê²€ì • ë†’ì´(black height)ê°€ ê¹¨ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ ê²½ìš°ë¥¼ ë‚˜ëˆ  ì²˜ë¦¬í•´

### ë ˆë“œë¸”ë™ íŠ¸ë¦¬ì˜ íšŒì „(ê· í˜•ì„ ìœ„í•œ í•µì‹¬)

- **ì¢ŒíšŒì „(Left Rotate)** : ë…¸ë“œê°€ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì¹˜ìš°ì³¤ì„ ë•Œ ì‚¬ìš©

- **ìš°íšŒì „(Right Rotate)** : ë…¸ë“œê°€ ì™¼ìª½ìœ¼ë¡œ ì¹˜ìš°ì³¤ì„ ë•Œ ì‚¬ìš©

ì´ íšŒì „ ì—°ì‚°ì€ íŠ¸ë¦¬ì˜ **BST ì„±ì§ˆ**ì€ ìœ ì§€í•˜ë©´ì„œ, êµ¬ì¡°ë¥¼ ì‚´ì§ ë°”ê¿”ì„œ ê· í˜•ì„ ë§ì¶°ì¤€ë‹¤

### ê·¸ë¦¼ìœ¼ë¡œ ì´í•´í•˜ê¸°

ì˜ˆì‹œ: ë ˆë“œë¸”ë™ íŠ¸ë¦¬ì— ë‹¤ìŒ ê°’ì„ ìˆœì„œëŒ€ë¡œ ì‚½ì…í•´ë³´ì

10 â†’ 18 â†’ 7 â†’ 15 â†’ 16
~~~css
      10(B)
~~~
#### Step 1: 10 ì‚½ì…

- íŠ¸ë¦¬ê°€ ë¹„ì–´ ìˆìœ¼ë‹ˆ 10ì„ ë£¨íŠ¸ë¡œ ë§Œë“ ë‹¤.

- ìƒˆ ë…¸ë“œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë¹¨ê°•ì´ì§€ë§Œ, ë£¨íŠ¸ëŠ” í•­ìƒ ê²€ì •ì´ì–´ì•¼ í•œë‹¤.

~~~css
      10(B)
          \
         18(R)
~~~
#### Step 2: 18 ì‚½ì…

- ì¼ë°˜ BST ë°©ì‹ìœ¼ë¡œ ì˜¤ë¥¸ìª½ì— ì‚½ì…

- ìƒˆ ë…¸ë“œëŠ” ë¹¨ê°•

~~~css
        10(B)
       /     \
    7(R)     18(R)
~~~
#### Step 3: 7 ì‚½ì…

- 7ì€ 10ë³´ë‹¤ ì‘ìœ¼ë‹ˆ ì™¼ìª½ì— ì‚½ì….

- ì—­ì‹œ ìƒˆ ë…¸ë“œëŠ” ë¹¨ê°•.

~~~css
        10(B)
       /     \
    7(R)     18(R)
            /
         15(R)
~~~
#### Step 4: 15 ì‚½ì…

- BST ìˆœì„œëŒ€ë¡œ 18ì˜ ì™¼ìª½ì— ì‚½ì…ë¨ (18ì˜ ì™¼ìª½ ìì‹)

- ìƒˆ ë…¸ë“œ 15ëŠ” ë¹¨ê°•

ğŸš¨ ë¬¸ì œ ë°œìƒ!

- 15(R)ì˜ ë¶€ëª¨ 18(R)ë„ ë¹¨ê°•ì´ë‹¤ â†’ Red-Red Violation! (ê·œì¹™ 4 ìœ„ë°˜)

#### í•´ê²°: ì‚¼ì´Œ ë…¸ë“œ ìƒ‰ í™•ì¸

- 15ì˜ ì‚¼ì´Œ ë…¸ë“œëŠ” 7(R) (ë¶€ëª¨ 18(R)ì˜ í˜•ì œ)

- ì‚¼ì´Œë„ ë¹¨ê°• â†’ Recoloring ì§„í–‰!

~~~css
ìƒ‰ ë°”ê¾¸ê¸°:
  - 18 â†’ ê²€ì •
  - 7  â†’ ê²€ì •
  - 10 â†’ ë¹¨ê°• (ë¶€ëª¨ë¡œ ì˜¬ë¼ê°)

        10(R)
       /     \
    7(B)     18(B)
            /
         15(R)
~~~

- â—ê·¼ë° 10ì€ ë£¨íŠ¸ â†’ ë£¨íŠ¸ëŠ” í•­ìƒ ê²€ì • â†’ ë‹¤ì‹œ 10 â†’ ê²€ì •ìœ¼ë¡œ ë°”ê¿ˆ

~~~css
       10(B)
       /     \
    7(B)     18(B)
            /
         15(R)
~~~

âœ” ê· í˜• ë³µêµ¬ ì™„ë£Œ âœ…

~~~css
        10(B)
       /     \
    7(B)     18(B)
            /
         15(R)
              \
             16(R)
~~~

#### Step 5: 16 ì‚½ì…

- 16ì€ 10 < 18 < 16 â†’ 18ì˜ ì™¼ìª½ â†’ 15ì˜ ì˜¤ë¥¸ìª½ì— ì‚½ì…

ğŸš¨ ë‹¤ì‹œ Red-Red ë°œìƒ

- 15(R) â†’ ë¶€ëª¨

- 16(R) â†’ ìì‹ â†’ Red-Red violation

#### í•´ê²°: ì‚¼ì´Œ ë…¸ë“œ ìƒ‰ í™•ì¸

- 16ì˜ ì‚¼ì´Œì€ ì—†ìŒ (NIL â†’ ê²€ì •)

- ì‚¼ì´Œì´ ê²€ì •ì´ê³ , ë…¸ë“œê°€ ë¶€ëª¨ì˜ ì˜¤ë¥¸ìª½ ìì‹ì¸ ê²½ìš° â†’ ì¢ŒíšŒì „ í›„ ìš°íšŒì „

~~~css
â†’ 15ì™€ 16ì˜ ê´€ê³„ ë³€ê²½
        18(B)
       /
    16(R)
    /
 15(R)
~~~

#### íšŒì „ + ìƒ‰ ë³€ê²½, ë¨¼ì € ì¢ŒíšŒì „(Left Rotate) on 15

~~~css
â†’ 16ì´ ìœ„ë¡œ ì˜¬ë¼ê° + 16 â†’ ê²€ì • / 18 â†’ ë¹¨ê°•
        10(B)
       /     \
    7(B)     16(B)
            /     \
         15(R)    18(R)
~~~

#### íšŒì „ + ìƒ‰ ë³€ê²½, ë‹¤ìŒ ìš°íšŒì „(Right Rotate) on 18 + ìƒ‰ ë³€ê²½

âœ” ìµœì¢… ê²°ê³¼, ê·œì¹™ ëª¨ë‘ ë§Œì¡± âœ…



| ìƒí™© | ì¡°ì¹˜ |
|:---:|:---:|
| ë¶€ëª¨, ì‚¼ì´Œ ëª¨ë‘ ë¹¨ê°• | ë¶€ëª¨/ì‚¼ì´Œ â†’ ê²€ì •, ì¡°ë¶€ëª¨ â†’ ë¹¨ê°• (Recolor) |
| ë¶€ëª¨ ë¹¨ê°•, ì‚¼ì´Œ ê²€ì •, ì‚½ì… ë…¸ë“œ ë°©í–¥ì´ êº¾ì—¬ ìˆìŒ | íšŒì „ í›„ ì¬ë°°ì¹˜ (Rotate) |
| ì‚½ì… ë…¸ë“œê°€ ë¶€ëª¨ì™€ ì¼ì§ì„  | í•œ ë²ˆì˜ íšŒì „ìœ¼ë¡œ ì¡°ì • |